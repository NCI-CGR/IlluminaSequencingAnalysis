This is the workflow for generating the PCs and relatedness of the COVNET samples using somalier v0.2.14. The executable and related reference files are downloaded from https://github.com/brentp/somalier/releases

1. Extract the informative sites from the BAM files
We executed the Snakemake workflow in workflow/snakemake, the samples are listed in workflow/samples.txt

2a. Ran somalier ancestry
data/COVID_WGS/ancestry_analysis/somalier/somalier_v0.2.14 ancestry --n-pcs 10 --labels /data/COVID_WGS/ancestry_analysis/somalier/ancestry-labels-1kg.tsv /data/COVID_WGS/ancestry_analysis/somalier/1kg-somalier/*.somalier ++ extracted/*
.somalier

2b. Remove 1000 genomes samples in somalier output
By default, somalier generates an output files of the PCs including the reference 1000 genomes samples. They are removed in the final output.

3. Ran somalier relate
/data/COVID_WGS/ancestry_analysis/somalier/somalier_v0.2.14 relate --ped samples.ped extracted/*.somalier

Please note that several pairs are closely related, WGS_SC682684_I3-97804	and WGS_SC682686_I3-97805	are genetically identical.
